version: 0.2

phases:
        install:
                commands:
                        - aws --version
                        - git --version

        pre-build:
                commands:
                        - aws ecr get-login-password --region eu-central-1 | docker login --username AWS --password-stdin 096387456865.dkr.ecr.eu-central-1.amazonaws.com

        build:
                commands:
                        - docker build -t 096387456865.dkr.ecr.eu-central-1.amazonaws.com/apache apache/
                        - docker build -t 096387456865.dkr.ecr.eu-central-1.amazonaws.com/nginx nginx/

        post_build:
                commands:
                        - docker push 096387456865.dkr.ecr.eu-central-1.amazonaws.com/apache
                        - docker push 096387456865.dkr.ecr.eu-central-1.amazonaws.com/nginx
